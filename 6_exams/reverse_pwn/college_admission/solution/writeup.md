# üîë Write-Up

For the first question, we can see with ida that the correct input is: `Anya Forger, Park Avenue 128`. 

The second and the third question is asked to enter a digit from 0 to 9, where the correct answer is always different. This result, is decided in `think()` function, that use a `rand()` to generate random numbers. What we can do replace the rand() function, with a register, where the value stored is fixed. In this way, the number that the function `think()` returns is always the same: 1.

Check out the `patch.diff` file.

Before we do that, there's the anti debugger thar will check if we are patching the code or using a debugger. Since we need to disable it, we can just `nop` the call of `stack trace` in the function `security_check()`.

### üö© Flag

```plain
SPRITZ{Ez_D3J4Vu?!?!}
```

```ascii
‚†Ä‚†Ä  ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£§‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚°è‚¢∑‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£Ä‚£§‚£¨‚£∑‚£ò‚£ß‚£§‚£§‚£Ä‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£¥‚†æ‚†ã‚¢Å‚£¢‚†ø‚†õ‚†õ‚†ª‚£¶‚°Ä‚†Ä‚°â‚†≥‚£¶‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£∞‚†ü‚†Å‚°Ñ‚†à‚£æ‚†ã‚¢Ä‚†Ç‚†å‚°ê‚†ò‚£∑‚†Ä‚°Ä‚†Ñ‚†à‚†ª‚£¶‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£†‚£§‚£∂‚°ø‚¢´‚†î‚†Ç‚¢Ä‚£º‚†ü‚£Ä‚†Ç‚†à‚††‚†ê‚†à‚†ô‚¢∑‚£Ñ‚†Ä‚†Ä‚†Ä‚¢ø‚£∑‚£∂‚£§‚£Ñ‚£Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∞‚£ø‚£ø‚£ø‚£Ø‚°ü‚¢∞‚†Ü‚†Ä‚¢Ä‚°æ‚†É‚£∏‚°á‚†Ä‚†å‚£Ä‚†Ä‚†Ä‚††‚†Ä‚†ô‚¢∑‚°Ä‚†Ä‚†à‚¢ª‚£ª‚£Ω‚£ø‚£ø‚£ø‚°Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢ø‚£ø‚£Ø‚°ø‚¢Ä‚°ø‚†Ä‚†Ä‚£æ‚†É‚†Ä‚£ø‚†Ä‚¢ò‚†Ä‚†Ä‚£ø‚†Ä‚†Ä‚¢¶‚°Ä‚†à‚¢ª‚£Ñ‚†Ä‚†à‚£∑‚¢ø‚°æ‚£ø‚°ø‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ò‚£ø‚£ø‚¢Å‚£º‚†á‚†Ä‚£∏‚°è‚¢∞‚°á‚£ø‚°Ü‚¢ò‚†Ä‚†Ä‚†π‚£ß‚†Ä‚†à‚£∑‚°Ä‚†Ä‚¢ª‚£Ñ‚†Ä‚¢ª‚£¨‚£ø‚£ø‚†á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚°á‚£∏‚£ø‚†Ä‚¢Ä‚£ø‚¢Ä‚£º‚£á‚°ø‚£ß‚¢∏‚£á‚£á‚†Ä‚¢ª‚£ß‚°Ä‚†ò‚£ø‚£†‚†Ä‚£ø‚†Ä‚¢∏‚£ø‚°ü‚£á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£æ‚†Å‚£ø‚£π‚†Ä‚¢∞‚£ø‚£æ‚£ø‚£ø‚£ø‚£æ‚£ß‚£ª‚£ø‚£¶‚£Ä‚£ª‚£ø‚£∂‚£ø‚£π‚£¶‚¢∏‚°á‚¢ò‚£Ø‚°á‚¢ª‚£¶‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£º‚£ø‚†∞‚¢ø‚£∏‚°Ö‚¢∏‚£ø‚£ø‚£ü‚£ø‚£ø‚£ø‚°ç‚†ô‚¢ß‚†à‚†â‚¢ª‚°ü‚¢ª‚£ø‚£ø‚£ø‚£ø‚£ó‚¢à‚£ø‚£á‚¢â‚£ø‚†≥‚£Ñ‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚°º‚£ø‚°á‚††‚†π‚£ø‚°á‚£æ‚£ø‚†°‚£ø‚£ø‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ò‚£ø‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£∏‚£ø‚°á‚¢Ç‚†º‚£ß‚†â‚£ù‚†≥‚¢¶‚£§‚£Ä‚†¥‚°Ü
‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£æ‚£∑‚£ø‚†á‚¢∏‚†Å‚¢ª‚£ø‚£º‚£ø‚°Ä‚†ª‚£ø‚°ø‚†è‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†∏‚£ø‚£ø‚°ø‚¢†‚°ü‚¢π‚£ø‚£ª‚†á‚£°‚¢ä‚¢π‚£∑‚°ò‚¢ø‚£¶‚£¥‚°∂‚†õ‚†Ä
‚†Ä‚†Ä‚†Ä‚¢†‚£æ‚£ø‚£ø‚£ø‚°é‚£Ω‚†Ç‚†Ñ‚†ª‚£Ø‚¢ß‚†Ä‚†ê‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚††‚†ñ‚†ã‚¢Ä‚£ø‚£ø‚°ü‚£Ä‚†≤‚°à‚¢º‚£ø‚£ø‚£û‚£Ø‚†Å‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚£æ‚£ø‚£ø‚£ø‚£ø‚£ß‚¢ª‚°á‚†å‚††‚†ô‚¢ø‚£∑‚°Ä‚†Ä‚†ô‚†≤‚¢§‚£§‚£Ä‚£Ä‚£†‚£§‚†¥‚†ö‚†Ä‚†Ä‚¢Ä‚£æ‚£ø‚°ü‚††‚°Ñ‚¢£‚°ë‚£æ‚£ø‚£ø‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚£ø‚£ø‚°ø‚£ø‚£ø‚£ø‚£º‚£ø‚£å‚¢ë‚°à‚†Ñ‚°ô‚¢∑‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£¥‚£ø‚£ø‚°ø‚¢à‚°ï‚°ò‚†Ñ‚£æ‚£ø‚£ø‚£ø‚£ø‚°ø‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†à‚†ª‚£∑‚°π‚¢ø‚£ø‚£∑‚¢ø‚£ø‚£Ü‚°ò‚¢†‚†Å‚†å‚¢ª‚£∑‚£∂‚°∂‚£§‚£§‚£§‚£§‚£∂‚£∂‚£ø‚£ø‚£ø‚£ø‚£ø‚†á‚†≤‚£å‚¢Ç‚£ø‚£ø‚£ø‚£ø‚£ü‚£ø‚†É‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†Å‚†Ä‚†ô‚£ø‚£ø‚°ø‚£ø‚£ø‚£∂‚£å‚°å‚†§‚¢ø‚°â‚†ª‚£¶‚£â‚£¨‚°ø‚†Ø‚†ô‚¢ø‚£ø‚£ø‚£ø‚£ø‚¢à‚£±‚£∂‚£ø‚£ø‚†ü‚£º‚£ø‚†ã‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£®‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∂‚°º‚°á‚†Ä‚£¥‚°ø‚£∑‚£Ñ‚†Ä‚†Ä‚£∏‚£ø‚£ø‚£ø‚£Ø‚£∂‚£ø‚£ø‚£è‚£Ä‚°º‚†ü‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£Ä‚£¥‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚°Å‚†ô‚¢ª‚£∑‚£ø‚°∑‚£æ‚£ø‚£ó‚†Ç‚¢π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚£¶‚£Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚£Ä‚£§‚£∂‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£Ø‚£º‚£ø‚£Ø‚£ø‚£§‚£º‚£Ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£∑‚£¶‚£Ä‚†Ä‚†Ä‚†Ä
‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°Ü‚†Ä
‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°ø‚†ü‚†õ‚¢π‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°è‚†ô‚†ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á‚†Ä
```